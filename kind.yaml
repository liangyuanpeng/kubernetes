kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
networking:
  kubeProxyMode: "nftables"
featureGates:
  "MutatingAdmissionPolicy": true
  "CBORServingAndStorage": true
containerdConfigPatches:
- |-
  [plugins."io.containerd.grpc.v1.cri".registry.mirrors."gcr.io"]
    endpoint = ["https://gcr.m.daocloud.io"]
  [plugins."io.containerd.grpc.v1.cri".registry.mirrors."docker.io"]
    endpoint = ["https://docker.m.daocloud.io"]
  [plugins."io.containerd.grpc.v1.cri".registry.mirrors."registry.k8s.io"]
    endpoint = ["https://registry.m.daocloud.io"]
nodes:
- role: control-plane
  image: ghcr.worker.liangyuanpeng.com/liangyuanpeng/kubernetes/kindnode:v1.34.0-alpha.0-865-g1fc30db6dc9-amd64
  extraPortMappings:
    - containerPort: 31009
      hostPort: 31009
      listenAddress: "0.0.0.0"
    - containerPort: 6379
      hostPort: 6379
      listenAddress: "0.0.0.0"
  extraMounts:
    - hostPath: /home/runner/work/myactions/myactions/kubernetespki
      containerPath: /etc/kubernetes/pki
  kubeadmConfigPatches:
  - |
    kind: ClusterConfiguration
    apiServer:
      extraArgs:
        runtime-config: api/all=true
        storage-media-type: application/json
    etcd:
      local:
        imageRepository: "registry.k8s.io"
        imageTag: "3.6.0-0"
